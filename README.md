
# Милые пёсики
У нас есть программа для загрузки [картинок собак](https://dog.ceo/dog-api/documentation). Для этой программы уже написан тест.  
На вход подается порода собаки. Функция находит одну случайную картинку этой собаки и загружает её на [Я.Диск](https://yandex.ru/dev/disk/poligon/).
Если у породы есть подпороды, то для каждой подпороды загружается по одной картинки.
Например, для doberman будет одна картинка, а для spaniel 7 картинок по одной на каждую подпороду.

# Задание:
Нужно перечислить 10 основных проблем в коде.  
Все найденные проблемы нужно отранжировать по критичности.

# Задание со звёздочкой:
Переписать код так, как Вы считаете нужным, исправив все проблемы.





Правки http-клиента:
1. Токен авторизации передается каждый раз вручную. Я вынес токен как отдельную константу наружу,
   а в класс аплоадера передаю в качестве параметра конструктора, при этом дав ему значение по умолчанию. 
   Это позволяет создавать экземпляр класса аплоадера как без указания токена авторизации, так и с указанием токена,
   если предполагается использование аплоадера от имени разных пользователей

2. Хедеры в аплоадере используются одни и те же - Content-Type, Accept, Authorization.
   Вынес этот набор как приватное поле, которое вычисляется во время инициализации.


3. Базовый урл для YaUploader имеет смысл вынести отдельно, а не указывать в каждом вызове.
   Можно оставить его в YaUploader'e как статическое поле класса, но я решил вынести в отдельный класс с базовыми урлами.
   В условиях, когда используется много http-клиентов, может возникать потребность иметь все базовые урлы в одном файле. 
   Также, если используется множество тестовых окружений,
   использование отдельного класса с урлами облегчит переключение между окружениями в тестах.
   
   Аналогично базовый урл dog-ceo.

4. Методы YaUploader не возвращают значение. Добавил возврат response.json()

5. Яндексовый клиент унес в отдельный файл. Собачий клиент выделил в отдельный класс и тоже унес.
   Выделил для хттп клиентов отдельную директорию network




Правки теста:
1. Тест не использует блага YaUploader'а, определяя запросы каждый раз на месте. Исправил. 

2. Убрал из теста бесполезный assert True. Вреда не несет, но и пользы в нем нет.

3. Убрал слово proverka из имени теста. Смотрится чужеродно, смысла не несет, т к префикс test в имени имеет тот же смысл.

3. Выделил "response['_embedded']['items']" как отдельную переменную, чтобы улучшить читабельность кода

4. Убрал лишний вызов get_sub_breeds(breed) - достаточно это сделать один раз и пользоваться результатом.

5. Убрал random.choice из списка пород с подпородами.
   Не стоит вносить элемент случайности в тест, т к тест должен быть предсказуем и выполнять понятный сценарий при каждом запуске.

6. Разделил тест на два: один проверяет породу без суб-пород, второй - породу с суб-породами.
   Считаю ветвление в тесте плохой практикой - по возможности стоит оформлять для разных веток отдельные кейсы,
   если это не влечет больших затрат на повторное прохождение сетапа теста. В данном случае этого не происходит.

  
